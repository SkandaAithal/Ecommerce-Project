/*! For license information please see 603.bc4a17d0.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkecom=self.webpackChunkecom||[]).push([[603],{603:function(n,e,t){t.r(e),t.d(e,{default:function(){return I}});var r,a=t(9439),s=t(2791),o=t(4164),i=t(168),c=t(4165),l=t(5861),p=t(4942),u=t(1413),d=t(1493),m=t(6031),f=t(5880),h=t(1087),g=t(4569),x=t.n(g),v=t(184);var y,b=m.ZP.div(r||(r=(0,i.Z)(['\n  p {\n    color: red;\n  }\n  .overlay {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(0, 0, 0, 0.253);\n    z-index: 100;\n  }\n  .login {\n    border-radius: 10px;\n    background-color: #ffffff;\n    width: 50dvw;\n    height: 45rem;\n    position: fixed;\n    inset: 0;\n    margin: auto;\n    z-index: 101;\n    box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);\n    &-close {\n      display: flex;\n      padding: 1.5rem 1.5rem 0;\n      justify-content: end;\n\n      &-icon {\n        font-size: 3rem;\n      }\n    }\n\n    &-body {\n      text-align: center;\n      max-width: 50rem;\n      margin: auto;\n      padding-inline: 2rem;\n      &-inputs {\n        display: flex;\n        flex-direction: column;\n        margin-top: 3rem;\n      }\n\n      &-end {\n        color: #f52f2f;\n        font-weight: bold;\n        margin-block: 2rem;\n      }\n      input {\n        border: 1px solid black !important;\n      }\n      input[type="submit"] {\n        cursor: pointer;\n        transition: all 0.2s;\n        margin-top: 3rem;\n\n        &:hover {\n          background-color: ',";\n          border: 1px solid ",";\n          color: ",";\n          transform: scale(0.9);\n        }\n      }\n    }\n  }\n\n  @media (max-width: ",") {\n    .login {\n      width: 80dvw;\n    }\n  }\n"])),(function(n){return n.theme.colors.white}),(function(n){return n.theme.colors.btn}),(function(n){return n.theme.colors.btn}),(function(n){return n.theme.media.mobile})),w=function(n){var e=n.setOpenOtp,t=n.fdata,r=n.setFdata,o=(0,d.S)().dispatchUser,i="http://localhost:4000/users/login",m=(0,s.useState)({}),g=(0,a.Z)(m,2),y=g[0],w=g[1],O=(0,s.useState)(!1),k=(0,a.Z)(O,2),j=k[0],N=k[1],Z=function(n){var e=n.target,a=e.name,s=e.value;r((0,u.Z)((0,u.Z)({},t),{},(0,p.Z)({},a,s)));var o=function(n,e){return"email"===n?e?/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)?{email:""}:{email:"email is not in right format"}:{email:"email is empty"}:"password"===n?e?e.length<8?{password:"password should more than 8 characters"}:/^[A-Za-z0-9\@!#$%&*^?]+$/.test(e)?{password:""}:{password:"password is not in right format"}:{password:"password is empty"}:void 0}(a,s);w((0,u.Z)((0,u.Z)({},y),o))};function I(){return(I=(0,l.Z)((0,c.Z)().mark((function n(r){var a,s,l,d;return(0,c.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,N(!0),r.preventDefault(),!Object.values(y).every((function(n){return""===n}))||!Object.values(t).every((function(n){return""!==n}))){n.next=13;break}return n.next=6,x().post(i,t);case 6:a=n.sent,s=a.data,N(!1),o({type:"SHOW_NOTIFICATION",payload:{message:s.message,color:"green"}}),e(!0),n.next=16;break;case 13:for(d in l=function(n){""===t[n]&&w((function(e){return(0,u.Z)((0,u.Z)({},e),{},(0,p.Z)({},n,"".concat(n," is empty")))}))},t)l(d);N(!1);case 16:n.next=22;break;case 18:n.prev=18,n.t0=n.catch(0),N(!1),o({type:"SHOW_NOTIFICATION",payload:{message:n.t0.response.data.message,color:"red"}});case 22:case"end":return n.stop()}}),n,null,[[0,18]])})))).apply(this,arguments)}return(0,v.jsxs)(b,{children:[(0,v.jsx)("div",{className:"overlay",onClick:function(){o({type:"CLOSE_LOGIN"})}}),(0,v.jsxs)("div",{className:"login",children:[(0,v.jsx)("div",{className:"login-close",children:(0,v.jsx)(f.Fk5,{onClick:function(){o({type:"CLOSE_LOGIN"})},className:"login-close-icon"})}),(0,v.jsxs)("div",{className:"login-body",children:[(0,v.jsx)("h2",{children:"Login.."}),(0,v.jsxs)("form",{onSubmit:function(n){return I.apply(this,arguments)},children:[(0,v.jsxs)("div",{className:"login-body-inputs",children:[(0,v.jsx)("input",{type:"email",id:"email",onChange:Z,name:"email",placeholder:"Email"}),y.email&&(0,v.jsx)("p",{children:y.email})]}),(0,v.jsxs)("div",{className:"login-body-inputs",children:[(0,v.jsx)("input",{type:"password",name:"password",id:"password",placeholder:"Password",onChange:Z}),y.password&&(0,v.jsx)("p",{children:y.password})]}),j?(0,v.jsx)("input",{type:"submit",value:"Loading...",disabled:!0}):(0,v.jsx)("input",{type:"submit",value:"Get OTP"})]}),(0,v.jsx)(h.rU,{to:"/signup",children:(0,v.jsx)("p",{className:"login-body-end",onClick:function(){o({type:"CLOSE_LOGIN"})},children:"Not Logged In? Create Your Account"})})]})]})]})},O=t(3433),k=t(4984),j=t(9866);var N=m.ZP.div(y||(y=(0,i.Z)(['\n  .overlay {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(0, 0, 0, 0.253);\n    z-index: 100;\n  }\n  .otp {\n    border-radius: 10px;\n    background-color: #ffffff;\n    width: 40dvw;\n    height: 35rem;\n    position: fixed;\n    inset: 0;\n    gap: 3rem;\n    display: flex;\n    align-items: center;\n    flex-direction: column;\n    padding-block: 4.5rem;\n    margin: auto;\n    z-index: 101;\n    box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);\n\n    &-form {\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n      align-items: center;\n      gap: 2rem;\n\n      &-input {\n        width: 5.5rem;\n        padding: 2rem;\n        border: 1px solid black;\n        font-size: 2rem;\n      }\n      &-message {\n        color: #9c0049;\n        font-weight: bold;\n        font-size: 1.75rem;\n\n        span {\n          text-decoration: underline;\n          font-size: 2rem;\n          color: #000000;\n          cursor: pointer;\n        }\n      }\n      &-wrapper {\n        display: flex;\n        gap: 1rem;\n      }\n    }\n  }\n  input[type="submit"] {\n    cursor: pointer;\n    transition: all 0.2s;\n    margin: 0;\n    &:hover {\n      background-color: ',";\n      border: 1px solid ",";\n      color: ",";\n      transform: scale(0.9);\n    }\n  }\n  @media (max-width: ",") {\n    .otp {\n      width: 90dvw;\n    }\n  }\n  @media (max-width: 998px) and (min-width: 768px) {\n    .otp {\n      width: 70vw;\n    }\n  }\n"])),(function(n){return n.theme.colors.white}),(function(n){return n.theme.colors.btn}),(function(n){return n.theme.colors.btn}),(function(n){return n.theme.media.mobile})),Z=function(n){var e=n.otpLength,t=n.fdata,r=n.setOpenOtp,o=t.email,i=t.password,p=(0,s.useState)(!1),u=(0,a.Z)(p,2),m=u[0],f=u[1],h="http://localhost:4000/users/verifyotp",g=(0,s.useState)(Array(e).fill("")),y=(0,a.Z)(g,2),b=y[0],w=y[1],Z=(0,s.useRef)([]),I=(0,s.useState)(60),S=(0,a.Z)(I,2),C=S[0],T=S[1],L=(0,d.S)().dispatchUser,E=(0,j.Q)().dispatchSeller,F="sX8nD4zH1cT6kA2yP7uV3wR9qG5pL0J9";function P(){return(P=(0,l.Z)((0,c.Z)().mark((function n(e){var t,a,s,i;return(0,c.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,e.preventDefault(),f(!0),t=b.join(""),C){n.next=9;break}L({type:"SHOW_NOTIFICATION",payload:{message:"OTP is Expired. Click on Send New OTP",color:"red"}}),f(!1),n.next=25;break;case 9:if(6===t.length){n.next=14;break}L({type:"SHOW_NOTIFICATION",payload:{message:"OTP should have 6 numbers",color:"red"}}),f(!1),n.next=25;break;case 14:return n.next=16,x().post(h,{email:o,otp:t});case 16:a=n.sent,s=a.data,localStorage.setItem("role",s.userData.role),i=(0,k.H)(s.token,F),localStorage.setItem("userToken",i),f(!1),r(!1),L({type:"LOGIN_SUCCESSFULL",payload:{message:s.message,userData:s.userData}}),E({type:"REFRESH"});case 25:n.next=31;break;case 27:n.prev=27,n.t0=n.catch(0),f(!1),L({type:"SHOW_NOTIFICATION",payload:{message:n.t0.response.data.message,color:"red"}});case 31:case"end":return n.stop()}}),n,null,[[0,27]])})))).apply(this,arguments)}(0,s.useEffect)((function(){var n=setInterval((function(){T((function(n){return n-1}))}),1e3);return C<=0&&clearInterval(n),function(){clearInterval(n)}}),[C]);var A=function(){var n=(0,l.Z)((0,c.Z)().mark((function n(){var e,t;return(0,c.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,f(!0),n.next=4,x().post("http://localhost:4000/users/login",{email:o,password:i});case 4:e=n.sent,t=e.data,T(60),f(!1),L({type:"SHOW_NOTIFICATION",payload:{message:t.message,color:"green"}}),n.next=15;break;case 11:n.prev=11,n.t0=n.catch(0),f(!1),L({type:"SHOW_NOTIFICATION",payload:{message:n.t0.response.data.message,color:"red"}});case 15:case"end":return n.stop()}}),n,null,[[0,11]])})));return function(){return n.apply(this,arguments)}}();return(0,s.useEffect)((function(){Z.current[0].focus()}),[]),(0,v.jsxs)(N,{children:[(0,v.jsx)("div",{className:"overlay",onClick:function(){L({type:"CLOSE_LOGIN"})}}),(0,v.jsxs)("div",{className:"otp",children:[(0,v.jsx)("h2",{children:"OTP Verification"}),(0,v.jsxs)("form",{className:"otp-form",onSubmit:function(n){return P.apply(this,arguments)},children:[(0,v.jsx)("div",{className:"otp-form-wrapper",children:b.map((function(n,e){return(0,v.jsx)("input",{type:"text",value:b[e],ref:function(n){return Z.current[e]=n},className:"otp-form-input",maxLength:1,onChange:function(n){!function(n,e){var t=(0,O.Z)(b);t[n]=e,w(t)}(e,n.target.value.replace(/[^0-9]/g,""))},onKeyUp:function(n){!function(n,e){e.preventDefault();var t=(0,O.Z)(b);"Backspace"===e.key&&n>0?(t[n]="",Z.current[n-1].focus()):"Backspace"===e.key&&0===n&&(t[n]="",Z.current[n].focus()),e.key.replace(/[^0-9]/g,"")&&n<b.length-1?(t[n]=e.key.replace(/[^0-9]/g,""),Z.current[n+1].focus()):e.key.replace(/[^0-9]/g,"")&&n<b.length&&(t[n]=e.key.replace(/[^0-9]/g,""),Z.current[n].focus()),w(t)}(e,n)},onPaste:function(n){!function(n){var e=n.clipboardData.getData("text");(e=e.slice(0,6).replace(/[^0-9]/g,"")).split("").forEach((function(n,e){w((function(t){var r=(0,O.Z)(t);return r[e]=n,r}))}))}(n)}},e)}))}),(0,v.jsx)("p",{className:"otp-form-message",children:C?"OTP expires in ".concat(C,"s"):(0,v.jsxs)(v.Fragment,{children:["OTP Expired ",(0,v.jsx)("span",{onClick:A,children:"Send New OTP"})]})}),m?(0,v.jsx)("input",{type:"submit",value:"Loading...",disabled:!0}):(0,v.jsx)("input",{type:"submit",value:"Login"})]})]})]})};var I=function(){var n=(0,s.useState)(!1),e=(0,a.Z)(n,2),t=e[0],r=e[1],i=(0,s.useState)({email:"",password:""}),c=(0,a.Z)(i,2),l=c[0],p=c[1];return o.createPortal((0,v.jsx)(v.Fragment,{children:t?(0,v.jsx)(Z,{otpLength:6,fdata:l,setOpenOtp:r}):(0,v.jsx)(w,{setFdata:p,fdata:l,setOpenOtp:r})}),document.getElementById("user-validation"))}}}]);
//# sourceMappingURL=603.bc4a17d0.chunk.js.map