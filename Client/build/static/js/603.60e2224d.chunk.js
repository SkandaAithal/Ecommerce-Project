/*! For license information please see 603.60e2224d.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkecom=self.webpackChunkecom||[]).push([[603],{603:function(e,n,t){t.r(n),t.d(n,{default:function(){return I}});var r,a=t(9439),s=t(2791),o=t(4164),i=t(168),c=t(4165),l=t(5861),p=t(4942),u=t(1413),d=t(1493),m=t(6031),f=t(5880),h=t(1087),g=t(4569),x=t.n(g),v=t(184);var y,b=m.ZP.div(r||(r=(0,i.Z)(['\n  p {\n    color: red;\n  }\n  .overlay {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(0, 0, 0, 0.253);\n    z-index: 100;\n  }\n  .login {\n    border-radius: 10px;\n    background-color: #ffffff;\n    width: 50dvw;\n    height: 45rem;\n    position: fixed;\n    inset: 0;\n    margin: auto;\n    z-index: 101;\n    box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);\n    &-close {\n      display: flex;\n      padding: 1.5rem 1.5rem 0;\n      justify-content: end;\n\n      &-icon {\n        font-size: 3rem;\n      }\n    }\n\n    &-body {\n      text-align: center;\n      max-width: 50rem;\n      margin: auto;\n      padding-inline: 2rem;\n      &-inputs {\n        display: flex;\n        flex-direction: column;\n        margin-top: 3rem;\n      }\n\n      &-end {\n        color: #f52f2f;\n        font-weight: bold;\n        margin-block: 2rem;\n      }\n      input {\n        border: 1px solid black !important;\n      }\n      input[type="submit"] {\n        cursor: pointer;\n        transition: all 0.2s;\n        margin-top: 3rem;\n\n        &:hover {\n          background-color: ',";\n          border: 1px solid ",";\n          color: ",";\n          transform: scale(0.9);\n        }\n      }\n    }\n  }\n\n  @media (max-width: ",") {\n    .login {\n      width: 80dvw;\n    }\n  }\n"])),(function(e){return e.theme.colors.white}),(function(e){return e.theme.colors.btn}),(function(e){return e.theme.colors.btn}),(function(e){return e.theme.media.mobile})),w=function(e){var n=e.setOpenOtp,t=e.fdata,r=e.setFdata,o=(0,d.S)().dispatchUser,i="https://ecommerce-server.uk.to/users/login",m=(0,s.useState)({}),g=(0,a.Z)(m,2),y=g[0],w=g[1],O=(0,s.useState)(!1),k=(0,a.Z)(O,2),j=k[0],N=k[1],Z=function(e){var n=e.target,a=n.name,s=n.value;r((0,u.Z)((0,u.Z)({},t),{},(0,p.Z)({},a,s)));var o=function(e,n){return"email"===e?n?/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(n)?{email:""}:{email:"email is not in right format"}:{email:"email is empty"}:"password"===e?n?n.length<8?{password:"password should more than 8 characters"}:/^[A-Za-z0-9\@!#$%&*^?]+$/.test(n)?{password:""}:{password:"password is not in right format"}:{password:"password is empty"}:void 0}(a,s);w((0,u.Z)((0,u.Z)({},y),o))};function I(){return(I=(0,l.Z)((0,c.Z)().mark((function e(r){var a,s,l,d;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,N(!0),r.preventDefault(),!Object.values(y).every((function(e){return""===e}))||!Object.values(t).every((function(e){return""!==e}))){e.next=13;break}return e.next=6,x().post(i,t);case 6:a=e.sent,s=a.data,N(!1),o({type:"SHOW_NOTIFICATION",payload:{message:s.message,color:"green"}}),n(!0),e.next=16;break;case 13:for(d in l=function(e){""===t[e]&&w((function(n){return(0,u.Z)((0,u.Z)({},n),{},(0,p.Z)({},e,"".concat(e," is empty")))}))},t)l(d);N(!1);case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(0),N(!1),o({type:"SHOW_NOTIFICATION",payload:{message:e.t0.response.data.message,color:"red"}});case 22:case"end":return e.stop()}}),e,null,[[0,18]])})))).apply(this,arguments)}return(0,v.jsxs)(b,{children:[(0,v.jsx)("div",{className:"overlay",onClick:function(){o({type:"CLOSE_LOGIN"})}}),(0,v.jsxs)("div",{className:"login",children:[(0,v.jsx)("div",{className:"login-close",children:(0,v.jsx)(f.Fk5,{onClick:function(){o({type:"CLOSE_LOGIN"})},className:"login-close-icon"})}),(0,v.jsxs)("div",{className:"login-body",children:[(0,v.jsx)("h2",{children:"Login.."}),(0,v.jsxs)("form",{onSubmit:function(e){return I.apply(this,arguments)},children:[(0,v.jsxs)("div",{className:"login-body-inputs",children:[(0,v.jsx)("input",{type:"email",id:"email",onChange:Z,name:"email",placeholder:"Email"}),y.email&&(0,v.jsx)("p",{children:y.email})]}),(0,v.jsxs)("div",{className:"login-body-inputs",children:[(0,v.jsx)("input",{type:"password",name:"password",id:"password",placeholder:"Password",onChange:Z}),y.password&&(0,v.jsx)("p",{children:y.password})]}),j?(0,v.jsx)("input",{type:"submit",value:"Loading...",disabled:!0}):(0,v.jsx)("input",{type:"submit",value:"Get OTP"})]}),(0,v.jsx)(h.rU,{to:"/signup",children:(0,v.jsx)("p",{className:"login-body-end",onClick:function(){o({type:"CLOSE_LOGIN"})},children:"Not Logged In? Create Your Account"})})]})]})]})},O=t(3433),k=t(4984),j=t(9866);var N=m.ZP.div(y||(y=(0,i.Z)(['\n  .overlay {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(0, 0, 0, 0.253);\n    z-index: 100;\n  }\n  .otp {\n    border-radius: 10px;\n    background-color: #ffffff;\n    width: 40dvw;\n    height: 35rem;\n    position: fixed;\n    inset: 0;\n    gap: 3rem;\n    display: flex;\n    align-items: center;\n    flex-direction: column;\n    padding-block: 4.5rem;\n    margin: auto;\n    z-index: 101;\n    box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);\n\n    &-form {\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n      align-items: center;\n      gap: 2rem;\n\n      &-input {\n        width: 5.5rem;\n        padding: 2rem;\n        border: 1px solid black;\n        font-size: 2rem;\n      }\n      &-message {\n        color: #9c0049;\n        font-weight: bold;\n        font-size: 1.75rem;\n\n        span {\n          text-decoration: underline;\n          font-size: 2rem;\n          color: #000000;\n          cursor: pointer;\n        }\n      }\n      &-wrapper {\n        display: flex;\n        gap: 1rem;\n      }\n    }\n  }\n  input[type="submit"] {\n    cursor: pointer;\n    transition: all 0.2s;\n    margin: 0;\n    &:hover {\n      background-color: ',";\n      border: 1px solid ",";\n      color: ",";\n      transform: scale(0.9);\n    }\n  }\n  @media (max-width: ",") {\n    .otp {\n      width: 90dvw;\n    }\n  }\n  @media (max-width: 998px) and (min-width: 768px) {\n    .otp {\n      width: 70vw;\n    }\n  }\n"])),(function(e){return e.theme.colors.white}),(function(e){return e.theme.colors.btn}),(function(e){return e.theme.colors.btn}),(function(e){return e.theme.media.mobile})),Z=function(e){var n=e.otpLength,t=e.fdata,r=e.setOpenOtp,o=t.email,i=t.password,p=(0,s.useState)(!1),u=(0,a.Z)(p,2),m=u[0],f=u[1],h="https://ecommerce-server.uk.to/users/verifyotp",g=(0,s.useState)(Array(n).fill("")),y=(0,a.Z)(g,2),b=y[0],w=y[1],Z=(0,s.useRef)([]),I=(0,s.useState)(60),S=(0,a.Z)(I,2),C=S[0],T=S[1],L=(0,d.S)().dispatchUser,E=(0,j.Q)().dispatchSeller,F="sX8nD4zH1cT6kA2yP7uV3wR9qG5pL0J9";function P(){return(P=(0,l.Z)((0,c.Z)().mark((function e(n){var t,a,s,i;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n.preventDefault(),f(!0),t=b.join(""),C){e.next=9;break}L({type:"SHOW_NOTIFICATION",payload:{message:"OTP is Expired. Click on Send New OTP",color:"red"}}),f(!1),e.next=25;break;case 9:if(6===t.length){e.next=14;break}L({type:"SHOW_NOTIFICATION",payload:{message:"OTP should have 6 numbers",color:"red"}}),f(!1),e.next=25;break;case 14:return e.next=16,x().post(h,{email:o,otp:t});case 16:a=e.sent,s=a.data,localStorage.setItem("role",s.userData.role),i=(0,k.H)(s.token,F),localStorage.setItem("userToken",i),f(!1),r(!1),L({type:"LOGIN_SUCCESSFULL",payload:{message:s.message,userData:s.userData}}),E({type:"REFRESH"});case 25:e.next=32;break;case 27:e.prev=27,e.t0=e.catch(0),f(!1),console.log(e.t0),L({type:"SHOW_NOTIFICATION",payload:{message:e.t0.response.data.message,color:"red"}});case 32:case"end":return e.stop()}}),e,null,[[0,27]])})))).apply(this,arguments)}(0,s.useEffect)((function(){var e=setInterval((function(){T((function(e){return e-1}))}),1e3);return C<=0&&clearInterval(e),function(){clearInterval(e)}}),[C]);var A=function(){var e=(0,l.Z)((0,c.Z)().mark((function e(){var n,t;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,f(!0),e.next=4,x().post("https://ecommerce-server.uk.to/users/login",{email:o,password:i});case 4:n=e.sent,t=n.data,T(60),f(!1),L({type:"SHOW_NOTIFICATION",payload:{message:t.message,color:"green"}}),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),f(!1),L({type:"SHOW_NOTIFICATION",payload:{message:e.t0.response.data.message,color:"red"}});case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();return(0,s.useEffect)((function(){Z.current[0].focus()}),[]),(0,v.jsxs)(N,{children:[(0,v.jsx)("div",{className:"overlay",onClick:function(){L({type:"CLOSE_LOGIN"})}}),(0,v.jsxs)("div",{className:"otp",children:[(0,v.jsx)("h2",{children:"OTP Verification"}),(0,v.jsxs)("form",{className:"otp-form",onSubmit:function(e){return P.apply(this,arguments)},children:[(0,v.jsx)("div",{className:"otp-form-wrapper",children:b.map((function(e,n){return(0,v.jsx)("input",{type:"text",value:b[n],ref:function(e){return Z.current[n]=e},className:"otp-form-input",maxLength:1,onChange:function(e){!function(e,n){var t=(0,O.Z)(b);t[e]=n,w(t)}(n,e.target.value.replace(/[^0-9]/g,""))},onKeyUp:function(e){!function(e,n){n.preventDefault();var t=(0,O.Z)(b);"Backspace"===n.key&&e>0?(t[e]="",Z.current[e-1].focus()):"Backspace"===n.key&&0===e&&(t[e]="",Z.current[e].focus()),n.key.replace(/[^0-9]/g,"")&&e<b.length-1?(t[e]=n.key.replace(/[^0-9]/g,""),Z.current[e+1].focus()):n.key.replace(/[^0-9]/g,"")&&e<b.length&&(t[e]=n.key.replace(/[^0-9]/g,""),Z.current[e].focus()),w(t)}(n,e)},onPaste:function(e){!function(e){var n=e.clipboardData.getData("text");(n=n.slice(0,6).replace(/[^0-9]/g,"")).split("").forEach((function(e,n){w((function(t){var r=(0,O.Z)(t);return r[n]=e,r}))}))}(e)}},n)}))}),(0,v.jsx)("p",{className:"otp-form-message",children:C?"OTP expires in ".concat(C,"s"):(0,v.jsxs)(v.Fragment,{children:["OTP Expired ",(0,v.jsx)("span",{onClick:A,children:"Send New OTP"})]})}),m?(0,v.jsx)("input",{type:"submit",value:"Loading...",disabled:!0}):(0,v.jsx)("input",{type:"submit",value:"Login"})]})]})]})};var I=function(){var e=(0,s.useState)(!1),n=(0,a.Z)(e,2),t=n[0],r=n[1],i=(0,s.useState)({email:"",password:""}),c=(0,a.Z)(i,2),l=c[0],p=c[1];return o.createPortal((0,v.jsx)(v.Fragment,{children:t?(0,v.jsx)(Z,{otpLength:6,fdata:l,setOpenOtp:r}):(0,v.jsx)(w,{setFdata:p,fdata:l,setOpenOtp:r})}),document.getElementById("user-validation"))}}}]);
//# sourceMappingURL=603.60e2224d.chunk.js.map